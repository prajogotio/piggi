<html>
<head>
	<script src="Vec2.js"></script>
	<script src="ds.js"></script>
	<script src="flocking.js"></script>
	<script src="qpath.js"></script>
</head>
<body>
	<canvas id="canvas" width="1024" height="640"></canvas>

	<script>
	var canvas = document.getElementById("canvas");
	var g = canvas.getContext("2d");
	var center = new Vec2(canvas.width/2, canvas.height/2);
	var f = [
		new Flocker(100, center),
		new Flocker(100, center),
		new Flocker(100, center),
		new Flocker(100, center),
		new Flocker(100, center),
		new Flocker(100, center),
		new Flocker(100, center),
		new Flocker(100, center),
		new Flocker(0, center),
		new Flocker(0, new Vec2(300, 300)),
		new Flocker(0, new Vec2(300, 400)),
		new Flocker(0, new Vec2(300, 200)),
		new Flocker(0, new Vec2(300, 250)),
		];
	var t = new Vec2(0, 0);
	canvas.addEventListener("mousedown", function(e) {
		var x = e.offsetX;
		var y = e.offsetY;
		t.x = x;
		t.y = y;
		for(var i=0;i<f.length;++i){
			f[i].target = t;
		}
	});
	setInterval(function(){
		g.clearRect(0, 0, canvas.width, canvas.height);
		g.fillStyle="red";
		g.fillRect(t.x-1,t.y-1,2,2);

		updateFlocking(f);
		
		for(var i=0;i<f.length;++i){
			g.save();
			g.translate(f[i].pos.x, f[i].pos.y);
			g.rotate(f[i].orientation/180*Math.PI);
			f[i].drawTest(g);
			g.restore();
		}

	}, 1000/60);
	</script>
</body>
</html>